class GitHubStatsHandler{constructor(){this.cachePrefix="github-stats-cache",this.cacheTimeout=864e5,this.statsConfig={"github-stats":{primary:"https://github-readme-stats.vercel.app/api?username=smpsandro1239&show_icons=true&theme=radical&hide_border=true&count_private=true&title_color=667eea&icon_color=667eea&text_color=ffffff&bg_color=0a0a0a&include_all_commits=true",fallback:"https://github-readme-stats-git-masterrstaa-rickstaa.vercel.app/api?username=smpsandro1239&show_icons=true&theme=radical&hide_border=true&count_private=true&title_color=667eea&icon_color=667eea&text_color=ffffff&bg_color=0a0a0a&include_all_commits=true"},"top-langs":{primary:"https://github-readme-stats.vercel.app/api/top-langs/?username=smpsandro1239&layout=compact&theme=radical&hide_border=true&title_color=667eea&text_color=ffffff&bg_color=0a0a0a",fallback:"https://github-readme-stats-git-masterrstaa-rickstaa.vercel.app/api/top-langs/?username=smpsandro1239&layout=compact&theme=radical&hide_border=true&title_color=667eea&text_color=ffffff&bg_color=0a0a0a"},"profile-summary":{primary:"https://github-profile-summary-cards.vercel.app/api/cards/profile-details?username=smpsandro1239&theme=radical",fallback:"https://github-profile-summary-cards.vercel.app/api/cards/repos-per-language?username=smpsandro1239&theme=radical"},"streak-stats":{primary:"https://github-readme-streak-stats.herokuapp.com/?user=smpsandro1239&theme=radical&hide_border=true&stroke=667eea&background=0a0a0a&fire=667eea&currStreakNum=667eea",fallback:"https://streak-stats.demolab.com?user=smpsandro1239&theme=radical&hide_border=true&stroke=667eea&background=0a0a0a&fire=667eea&currStreakNum=667eea"},"activity-graph":{primary:"https://github-readme-activity-graph.vercel.app/graph?username=smpsandro1239&theme=react-dark&bg_color=0a0a0a&color=667eea&line=667eea&point=ffffff&hide_border=true&area=true",fallback:"https://activity-graph.herokuapp.com/graph?username=smpsandro1239&theme=react-dark&bg_color=0a0a0a&color=667eea&line=667eea&point=ffffff&hide_border=true&area=true"}},this.retryAttempts=new Map,this.maxRetries=3,this.retryDelay=3e3,this.loadTimeout=15e3}init(){console.log("Initializing GitHub Stats Handler..."),this.setupStatsImages(),this.addRefreshButton(),this.addGlobalErrorHandler()}setupStatsImages(){const t=document.querySelector(".github-stats");if(!t)return void console.warn("GitHub stats section not found");const e=t.querySelectorAll("img");console.log(`Found ${e.length} GitHub stats images`),e.forEach((t,e)=>{const a=this.getStatsTypeFromAlt(t)||this.getStatsTypeFromSrc(t);console.log(`Image ${e+1}: ${a||"unknown type"}`),a&&this.statsConfig[a]?this.setupImageWithFallback(t,a):console.warn("Unknown stats type for image:",t.src)})}getStatsTypeFromAlt(t){const e=t.alt.toLowerCase();return e.includes("estat√≠sticas github")?"github-stats":e.includes("linguagens mais usadas")?"top-langs":e.includes("resumo detalhado")||e.includes("perfil github")?"profile-summary":e.includes("sequ√™ncia")||e.includes("contribui√ß√µes")?"streak-stats":e.includes("gr√°fico de atividade")||e.includes("atividade")?"activity-graph":null}getStatsTypeFromSrc(t){const e=t.src;return e.includes("github-readme-stats")&&e.includes("top-langs")?"top-langs":e.includes("github-readme-stats")?"github-stats":e.includes("github-profile-summary-cards")?"profile-summary":e.includes("streak-stats")?"streak-stats":e.includes("activity-graph")?"activity-graph":null}setupImageWithFallback(t,e){const a=this.statsConfig[e];console.log(`Setting up ${e} with primary URL:`,a.primary);const r=this.getCachedImage(e);if(r)return console.log(`Using cached image for ${e}`),t.src=r,void this.removeLoadingIndicator(t);t.onerror=null,t.onload=null;const s=a.primary+(a.primary.includes("?")?"&":"?")+"t="+Date.now();t.src=s,this.addLoadingIndicator(t,e);const o=setTimeout(()=>{console.warn(`${e} loading timeout`),this.handleImageError(t,e)},this.loadTimeout);t.onload=()=>{console.log(`${e} loaded successfully`),clearTimeout(o),this.removeLoadingIndicator(t),this.cacheImage(e,t.src)},t.onerror=()=>{console.warn(`${e} failed to load, trying fallback`),clearTimeout(o),this.handleImageError(t,e)}}handleImageError(t,e){const a=this.retryAttempts.get(e)||0;console.log(`Handling error for ${e}, attempt ${a+1}/${this.maxRetries}`),a<this.maxRetries?(this.retryAttempts.set(e,a+1),setTimeout(()=>{const r=this.statsConfig[e],s=0===a?r.fallback:r.primary,o=s+(s.includes("?")?"&":"?")+"t="+Date.now()+"&retry="+a;console.log(`Retrying ${e} with URL:`,o),t.src=o},this.retryDelay)):(console.error(`${e} failed after ${this.maxRetries} attempts`),this.showErrorPlaceholder(t,e))}addLoadingIndicator(t,e){const a=t.parentElement,r=a.querySelector(".stats-loading");r&&r.remove();const s=document.createElement("div");s.className="stats-loading",s.innerHTML=`\n            <div class="loading-spinner"></div>\n            <p>A carregar ${this.getDisplayName(e)}...</p>\n        `,t.style.opacity="0",a.appendChild(s)}removeLoadingIndicator(t){const e=t.parentElement.querySelector(".stats-loading");e&&e.remove(),t.style.opacity="1"}getDisplayName(t){return{"github-stats":"estat√≠sticas","top-langs":"linguagens","profile-summary":"resumo do perfil","streak-stats":"sequ√™ncia de contribui√ß√µes","activity-graph":"gr√°fico de atividade"}[t]||"gr√°fico"}showErrorPlaceholder(t,e){const a=t.parentElement;this.removeLoadingIndicator(t);const r=document.createElement("div");r.className="stats-error",r.innerHTML=`\n            <div class="error-icon">üìä</div>\n            <p>${this.getDisplayName(e)} temporariamente indispon√≠vel</p>\n            <button class="retry-btn" onclick="window.githubStatsHandler.retryImage('${e}')">\n                Tentar novamente\n            </button>\n        `,t.style.display="none",a.appendChild(r)}retryImage(t){console.log(`Manual retry for ${t}`),this.retryAttempts.delete(t);const e=document.querySelectorAll(".stat-card, .stats-streak, .stats-profile, .stats-activity");let a=null;if(e.forEach(e=>{const r=e.querySelector(".stats-error");r&&r.innerHTML.includes(this.getDisplayName(t))&&(a=e)}),a){const e=a.querySelector(".stats-error");e&&e.remove();let r=a.querySelector("img");r||(r=document.createElement("img"),r.alt=this.getAltText(t),r.loading="lazy",a.appendChild(r)),r.style.display="block",r.style.opacity="0",this.setupImageWithFallback(r,t)}}getAltText(t){return{"github-stats":"Estat√≠sticas GitHub","top-langs":"Linguagens Mais Usadas","profile-summary":"Resumo Detalhado do Perfil GitHub","streak-stats":"Sequ√™ncia de Contribui√ß√µes","activity-graph":"Gr√°fico de Atividade"}[t]||"Estat√≠stica GitHub"}addRefreshButton(){const t=document.querySelector(".github-stats");if(t&&!t.querySelector(".stats-refresh-btn")){const e=document.createElement("button");e.className="stats-refresh-btn",e.innerHTML="üîÑ Atualizar Estat√≠sticas",e.onclick=()=>{window.githubStatsHandler.refreshAllStats()},t.appendChild(e)}}refreshAllStats(){console.log("Refreshing all GitHub stats..."),this.retryAttempts.clear();const t=document.querySelector(".github-stats");if(!t)return;t.querySelectorAll("img").forEach(t=>{const e=this.getStatsTypeFromAlt(t)||this.getStatsTypeFromSrc(t);if(e&&this.statsConfig[e]){const a=t.parentElement.querySelector(".stats-error");a&&a.remove(),t.style.display="block",this.setupImageWithFallback(t,e)}})}addGlobalErrorHandler(){window.addEventListener("error",t=>{if(t.target&&"IMG"===t.target.tagName){const e=t.target,a=document.querySelector(".github-stats");if(a&&a.contains(e)){const t=this.getStatsTypeFromAlt(e)||this.getStatsTypeFromSrc(e);t&&!this.retryAttempts.has(t)&&(console.log(`Global error handler caught ${t}`),this.handleImageError(e,t))}}},!0)}cacheImage(t,e){try{const a=`${this.cachePrefix}-${t}`,r={url:e,timestamp:Date.now()};localStorage.setItem(a,JSON.stringify(r)),console.log(`Cached ${t} image`)}catch(e){console.warn(`Failed to cache ${t}:`,e)}}getCachedImage(t){try{const e=`${this.cachePrefix}-${t}`,a=localStorage.getItem(e);if(!a)return null;const r=JSON.parse(a);return Date.now()-r.timestamp<this.cacheTimeout?r.url:(localStorage.removeItem(e),null)}catch(e){return console.warn(`Failed to get cached ${t}:`,e),null}}clearCache(){try{const t=Object.keys(localStorage).filter(t=>t.startsWith(this.cachePrefix));t.forEach(t=>{localStorage.removeItem(t)}),console.log(`Cleared ${t.length} cached images`)}catch(t){console.warn("Failed to clear cache:",t)}}}const githubStatsHandler=new GitHubStatsHandler;window.githubStatsHandler=githubStatsHandler,window.githubStats=githubStatsHandler,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded, initializing GitHub stats..."),githubStatsHandler.init()}):(console.log("DOM already loaded, initializing GitHub stats..."),githubStatsHandler.init());export default GitHubStatsHandler;