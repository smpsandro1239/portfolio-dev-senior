export class ThemeManager{constructor(){this.storageKey="portfolio-theme",this.themes={LIGHT:"light",DARK:"dark",AUTO:"auto"},this.currentTheme=this.themes.AUTO,this.systemPreference=this.getSystemPreference(),this.handleToggleClick=this.handleToggleClick.bind(this),this.handleSystemPreferenceChange=this.handleSystemPreferenceChange.bind(this),this.handleKeyboardToggle=this.handleKeyboardToggle.bind(this)}init(){try{this.loadTheme(),this.setupEventListeners(),this.applyTheme(),console.log("Theme manager initialized")}catch(e){console.error("Error initializing theme manager:",e),this.setTheme(this.themes.LIGHT)}}setupEventListeners(){const e=document.querySelector(".theme-toggle");e&&(e.addEventListener("click",this.handleToggleClick),e.addEventListener("keydown",this.handleKeyboardToggle));const t=window.matchMedia("(prefers-color-scheme: dark)");t.addEventListener?t.addEventListener("change",this.handleSystemPreferenceChange):t.addListener(this.handleSystemPreferenceChange)}loadTheme(){try{const e=localStorage.getItem(this.storageKey);e&&Object.values(this.themes).includes(e)?this.currentTheme=e:this.currentTheme=this.systemPreference}catch(e){console.warn("Could not load theme from localStorage:",e),this.currentTheme=this.systemPreference}}getSystemPreference(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.themes.DARK:this.themes.LIGHT}applyTheme(){const e=this.currentTheme===this.themes.AUTO?this.systemPreference:this.currentTheme;document.documentElement.setAttribute("data-theme",e),this.updateToggleButton(e),this.dispatchThemeChangeEvent(e),console.log(`Theme applied: ${e}`)}updateToggleButton(e){const t=document.querySelector(".theme-toggle");if(!t)return;if(!t.querySelector(".theme-toggle__icon"))return;const s=e===this.themes.DARK?"claro":"escuro";t.setAttribute("aria-label",`Mudar para tema ${s}`),t.setAttribute("title",`Mudar para tema ${s}`),t.classList.toggle("theme-toggle--dark",e===this.themes.DARK)}setTheme(e){Object.values(this.themes).includes(e)?(this.currentTheme=e,this.saveTheme(),this.applyTheme()):console.warn(`Invalid theme: ${e}`)}toggleTheme(){const e=(this.currentTheme===this.themes.AUTO?this.systemPreference:this.currentTheme)===this.themes.DARK?this.themes.LIGHT:this.themes.DARK;this.setTheme(e)}saveTheme(){try{localStorage.setItem(this.storageKey,this.currentTheme)}catch(e){console.warn("Could not save theme to localStorage:",e)}}handleToggleClick(e){e.preventDefault(),this.toggleTheme(),"vibrate"in navigator&&navigator.vibrate(50)}handleKeyboardToggle(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.toggleTheme())}handleSystemPreferenceChange(e){this.systemPreference=e.matches?this.themes.DARK:this.themes.LIGHT,this.currentTheme===this.themes.AUTO&&this.applyTheme(),console.log(`System preference changed to: ${this.systemPreference}`)}dispatchThemeChangeEvent(e){const t=new CustomEvent("themechange",{detail:{theme:e,userPreference:this.currentTheme,systemPreference:this.systemPreference}});document.dispatchEvent(t)}getCurrentTheme(){return{current:this.currentTheme,applied:this.currentTheme===this.themes.AUTO?this.systemPreference:this.currentTheme,system:this.systemPreference}}isDarkTheme(){return(this.currentTheme===this.themes.AUTO?this.systemPreference:this.currentTheme)===this.themes.DARK}resetToSystemPreference(){this.setTheme(this.themes.AUTO)}destroy(){const e=document.querySelector(".theme-toggle");e&&(e.removeEventListener("click",this.handleToggleClick),e.removeEventListener("keydown",this.handleKeyboardToggle));const t=window.matchMedia("(prefers-color-scheme: dark)");t.removeEventListener?t.removeEventListener("change",this.handleSystemPreferenceChange):t.removeListener(this.handleSystemPreferenceChange),console.log("Theme manager destroyed")}}